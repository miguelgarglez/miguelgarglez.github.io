---
import { Icon } from 'astro-icon/components';
---

<section id="education" class="education">
  <div class="container">
    <h2 class="section-title">Education</h2>

    <div class="education-grid">
      <div class="education-item">
        <Icon
          class="education-icon"
          name="lucide:graduation-cap"
          aria-hidden="true"
        />
        <h3 class="degree">Master's Degree in Computer Science</h3>
        <p class="institution">Universidad Autónoma de Madrid</p>
        <p class="period">September 2022 - February 2024</p>
        <p class="exchange">
          Exchange Program: Aalto University (Helsinki, Finland)
        </p>
        <p class="exchange-period">January 2023 – June 2023</p>
      </div>

      <div class="education-item">
        <Icon class="education-icon" name="lucide:book-open" aria-hidden="true" />
        <h3 class="degree">Bachelor's Degree in Computer Science</h3>
        <p class="institution">Universidad Autónoma de Madrid</p>
        <p class="period">September 2018 - June 2022</p>
      </div>
    </div>

    <div class="certifications">
      <h3 class="subsection-title">Courses & Certifications</h3>
      <div class="certifications-grid">
        <a
          class="certification-card certification-card-link"
          href="https://www.credly.com/badges/78c42e63-cb83-4914-8607-4073c40599a3/linked_in_profile"
          target="_blank"
          rel="noreferrer"
          aria-label="View credential for Professional Scrum Master I (PSM I)"
        >
          <h4 class="certification-title">Professional Scrum Master I (PSM I)</h4>
          <p class="certification-issuer">Scrum.org</p>
          <span class="certification-date">Oct 2025</span>
          <span class="certification-link" aria-hidden="true">
            <Icon class="certification-link-icon" name="lucide:arrow-up-right" />
          </span>
        </a>
        <a
          class="certification-card certification-card-link"
          href="https://animations.dev/certificate/6372ea11-f38d-45be-9c2f-9817e68b90a6"
          target="_blank"
          rel="noreferrer"
          aria-label="View credential for Animations on the Web"
        >
          <h4 class="certification-title">Animations on the Web</h4>
          <p class="certification-issuer">Emil Kowalski</p>
          <span class="certification-date">Aug 2025</span>
          <span class="certification-link" aria-hidden="true">
            <Icon class="certification-link-icon" name="lucide:arrow-up-right" />
          </span>
        </a>
        <a
          class="certification-card certification-card-link"
          href="https://www.kaggle.com/certification/badges/miguelgarglez/96"
          target="_blank"
          rel="noreferrer"
          aria-label="View credential for Google GenAI Intensive"
        >
          <h4 class="certification-title">Google GenAI Intensive</h4>
          <p class="certification-issuer">Kaggle</p>
          <span class="certification-date">Apr 2025</span>
          <span class="certification-link" aria-hidden="true">
            <Icon class="certification-link-icon" name="lucide:arrow-up-right" />
          </span>
        </a>
        <div
          class="certifications-collapse"
          id="certifications-extra"
          data-cert-collapse
          data-open="false"
        >
          <div class="certifications-collapse-inner">
            <div class="certifications-grid certifications-grid-extra">
              <a
                class="certification-card certification-card-link"
                href="https://learn.founderz.com/certificate/curso-generacion-ia-comunidad-madrid/7ca969ab-1671-4608-9c40-8b87d3bbfddf"
                target="_blank"
                rel="noreferrer"
                aria-label="View credential for Responsible AI and Prompt Engineering"
              >
                <h4 class="certification-title">
                  Responsible AI and Prompt Engineering (Online Course)
                </h4>
                <p class="certification-issuer">Founderz</p>
                <span class="certification-date">Mar 2025</span>
                <span class="certification-link" aria-hidden="true">
                  <Icon
                    class="certification-link-icon"
                    name="lucide:arrow-up-right"
                  />
                </span>
              </a>
              <a
                class="certification-card certification-card-link"
                href="https://www.linkedin.com/in/miguel-garciag/details/certifications/"
                target="_blank"
                rel="noreferrer"
                aria-label="View credential for TOEIC - C1 CEFR Level"
              >
                <h4 class="certification-title">TOEIC - C1 CEFR Level</h4>
                <p class="certification-issuer">Capman Testing Solutions</p>
                <span class="certification-date">Feb 2025</span>
                <span class="certification-link" aria-hidden="true">
                  <Icon
                    class="certification-link-icon"
                    name="lucide:arrow-up-right"
                  />
                </span>
              </a>
              <a
                class="certification-card certification-card-link"
                href="https://studies.cs.helsinki.fi/stats/api/certificate/fullstackopen/en/db1060c383cd09cd6ab128fb5f864156"
                target="_blank"
                rel="noreferrer"
                aria-label="View credential for Full Stack Open"
              >
                <h4 class="certification-title">Full Stack Open</h4>
                <p class="certification-issuer">University of Helsinki</p>
                <span class="certification-date">Apr 2024</span>
                <span class="certification-link" aria-hidden="true">
                  <Icon
                    class="certification-link-icon"
                    name="lucide:arrow-up-right"
                  />
                </span>
              </a>
            </div>
          </div>
        </div>
      </div>
      <button
        class="certifications-toggle"
        type="button"
        aria-expanded="false"
        aria-controls="certifications-extra"
        data-cert-toggle
      >
        <span class="certifications-toggle-label">Show all</span>
        <Icon class="certifications-toggle-icon" name="lucide:chevron-down" />
      </button>
    </div>
  </div>
</section>

<script>
  import gsap from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener('DOMContentLoaded', () => {
    const certsToggle = document.querySelector('[data-cert-toggle]');
    const certsCollapse = document.querySelector('[data-cert-collapse]');

    if (certsToggle && certsCollapse) {
      const collapsedLinks = certsCollapse.querySelectorAll('a');
      const toggleLabel = certsToggle.querySelector(
        '.certifications-toggle-label'
      );
      const mediaQuery = window.matchMedia('(min-width: 769px)');

      const setCertsOpen = (isOpen) => {
        certsCollapse.setAttribute('data-open', String(isOpen));
        certsToggle.setAttribute('aria-expanded', String(isOpen));
        if (toggleLabel) {
          toggleLabel.textContent = isOpen ? 'Show less' : 'Show all';
        }

        collapsedLinks.forEach((link) => {
          if (isOpen) {
            link.removeAttribute('tabindex');
            link.removeAttribute('aria-hidden');
          } else {
            link.setAttribute('tabindex', '-1');
            link.setAttribute('aria-hidden', 'true');
          }
        });
      };

      const syncCerts = () => {
        setCertsOpen(mediaQuery.matches ? true : false);
      };

      syncCerts();

      certsToggle.addEventListener('click', () => {
        const isOpen = certsCollapse.getAttribute('data-open') === 'true';
        setCertsOpen(!isOpen);
      });

      if (mediaQuery.addEventListener) {
        mediaQuery.addEventListener('change', syncCerts);
      } else if (mediaQuery.addListener) {
        mediaQuery.addListener(syncCerts);
      }
    }

    // Establecer estado inicial para las animaciones
    gsap.set('#education .section-title', { y: 50, opacity: 0 });
    gsap.set('#education .education-item', { y: 80, opacity: 0 });
    gsap.set('#education .education-icon', {
      scale: 0,
      rotation: 180,
      opacity: 0,
    });

    // Animación del título
    gsap.to('#education .section-title', {
      y: 0,
      opacity: 1,
      duration: 1,
      ease: 'power2.out',
      scrollTrigger: {
        trigger: '#education',
        start: 'top 70%',
        end: 'bottom 70%',
        toggleActions: 'play none none reverse',
      },
    });

    // Animación de las tarjetas de educación
    gsap.to('#education .education-item', {
      y: 0,
      opacity: 1,
      duration: 0.8,
      stagger: 0.3,
      ease: 'power2.out',
      scrollTrigger: {
        trigger: '#education .education-grid',
        start: 'top 80%',
        end: 'bottom 80%',
        toggleActions: 'play none none reverse',
      },
    });

    // Animación de los iconos
    gsap.to('#education .education-icon', {
      scale: 1,
      rotation: 0,
      opacity: 1,
      duration: 0.6,
      stagger: 0.2,
      ease: 'back.out(1.7)',
      scrollTrigger: {
        trigger: '#education .education-grid',
        start: 'top 80%',
        end: 'bottom 80%',
        toggleActions: 'play none none reverse',
      },
    });
  });
</script>

<style>
  .education {
    padding: 5rem 2rem;
    background: var(--bg);
    color: var(--text);
    --ease-out-quart: cubic-bezier(0.165, 0.84, 0.44, 1);
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .section-title {
    font-size: clamp(2rem, 4vw, 3rem);
    text-align: center;
    margin-bottom: 4rem;
    color: var(--text);
    font-weight: 700;
  }

  .education-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 3rem;
    max-width: 900px;
    margin: 0 auto;
  }

  .education-item {
    background: var(--bg-light);
    padding: 3rem 2rem;
    border-radius: 16px;
    text-align: center;
    border: 1px solid var(--border-muted);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .education-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.05),
      transparent
    );
    transition: left 0.8s ease;
  }

  .education-item:hover::before {
    left: 100%;
  }

  .education-item:hover {
    transform: translateY(-10px);
    border-color: var(--primary);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  }

  .education-icon {
    width: 64px;
    height: 64px;
    margin: 0 auto 1.5rem;
    display: block;
    color: var(--primary);
    stroke: currentColor;
    stroke-width: 1.8;
    fill: none;
    stroke-linecap: round;
    stroke-linejoin: round;
  }

  .degree {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text);
    margin: 0 0 1rem 0;
    line-height: 1.3;
  }

  .institution {
    font-size: 1.2rem;
    color: var(--primary);
    font-weight: 600;
    margin: 0 0 1rem 0;
  }

  .period {
    color: var(--text-muted);
    font-size: 1rem;
    margin: 0 0 1.5rem 0;
  }

  .exchange {
    color: var(--primary);
    font-weight: 600;
    font-size: 1rem;
    margin: 0 0 0.5rem 0;
  }

  .exchange-period {
    color: var(--text-muted);
    font-size: 0.9rem;
    margin: 0;
  }

  .certifications {
    margin-top: 4.5rem;
  }

  .subsection-title {
    text-align: center;
    font-size: clamp(1.4rem, 3vw, 2rem);
    color: var(--text);
    margin: 0 0 2.5rem 0;
    font-weight: 700;
  }

  .certifications-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 1.8rem;
    max-width: 900px;
    margin: 0 auto;
  }

  .certifications-collapse {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.45s var(--ease-out-quart);
    grid-column: 1 / -1;
  }

  .certifications-collapse-inner {
    overflow: hidden;
    opacity: 0;
    transform: translateY(-8px);
    transition: opacity 0.3s var(--ease-out-quart),
      transform 0.3s var(--ease-out-quart);
  }

  .certifications-grid-extra {
    margin-top: 0;
  }

  .certifications-collapse[data-open='true'] {
    grid-template-rows: 1fr;
  }

  .certifications-collapse[data-open='true'] .certifications-collapse-inner {
    opacity: 1;
    transform: translateY(0);
  }

  .certifications-toggle {
    margin: 2rem auto 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    width: fit-content;
    padding: 0.6rem 1.4rem;
    border-radius: 999px;
    border: 1px solid rgba(242, 169, 59, 0.4);
    background: rgba(242, 169, 59, 0.12);
    color: var(--primary);
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s var(--ease-out-quart),
      border-color 0.2s var(--ease-out-quart),
      color 0.2s var(--ease-out-quart);
  }

  .certifications-toggle:hover {
    transform: translateY(-2px);
    border-color: var(--primary);
    color: var(--primary);
  }

  .certifications-toggle-icon {
    width: 18px;
    height: 18px;
    stroke: currentColor;
    stroke-width: 2;
    transition: transform 0.3s var(--ease-out-quart);
  }

  .certifications-toggle[aria-expanded='true'] .certifications-toggle-icon {
    transform: rotate(180deg);
  }

  .certifications-toggle:focus-visible {
    outline: 2px solid var(--primary);
    outline-offset: 4px;
  }

  .certification-card {
    background: var(--bg-light);
    border: 1px solid var(--border-muted);
    border-radius: 14px;
    padding: 1.8rem;
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    transition: all 0.3s ease;
    position: relative;
  }

  .certification-card:hover {
    transform: translateY(-6px);
    border-color: var(--primary);
    box-shadow: 0 16px 30px rgba(0, 0, 0, 0.28);
  }

  .certification-card-link {
    text-decoration: none;
    color: inherit;
  }

  .certification-card-link:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--primary) inset;
  }

  .certification-title {
    margin: 0;
    font-size: 1.1rem;
    color: var(--text);
    font-weight: 700;
    line-height: 1.4;
  }

  .certification-issuer {
    margin: 0;
    color: var(--text-muted);
    font-size: 0.95rem;
    font-weight: 500;
  }

  .certification-date {
    align-self: flex-start;
    padding: 0.3rem 0.75rem;
    border-radius: 999px;
    background: rgba(242, 169, 59, 0.15);
    color: var(--primary);
    font-size: 0.85rem;
    font-weight: 600;
  }

  .certification-link {
    position: absolute;
    right: 1.6rem;
    bottom: 1.6rem;
    width: 40px;
    height: 40px;
    border-radius: 999px;
    border: 1px solid rgba(242, 169, 59, 0.4);
    color: var(--primary);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .certification-card-link:hover .certification-link {
    border-color: var(--primary);
    background: rgba(242, 169, 59, 0.12);
    transform: scale(1.02);
  }

  .certification-link-icon {
    width: 18px;
    height: 18px;
    stroke: currentColor;
    stroke-width: 2;
  }

  @media (max-width: 768px) {
    .education {
      padding: 3rem 1rem;
    }

    .education-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .education-item {
      padding: 2rem 1.5rem;
    }

    .certifications-grid {
      grid-template-columns: 1fr;
    }

    .certification-card:hover {
      transform: none;
    }

    .certification-card-link:hover .certification-link {
      transform: none;
    }
  }

  @media (min-width: 769px) {
    .certifications-collapse {
      display: contents;
    }

    .certifications-collapse-inner {
      display: contents;
    }

    .certifications-grid-extra {
      display: contents;
    }

    .certifications-toggle {
      display: none;
    }
  }
</style>
